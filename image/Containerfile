FROM quay.io/fedora/fedora-bootc:42

# Install packages - no configuration
RUN dnf install -y \
    # Virtualization
    qemu-kvm libvirt virt-install \
    # Containers
    podman cockpit cockpit-machines cockpit-podman \
    # Storage tools
    fuse fuse3 smartmontools hdparm \
    # Utilities
    vim tmux htop \
    && systemctl enable libvirtd cockpit.socket smartd

# Install snapraid (available in Fedora repos)
RUN dnf install -y snapraid && dnf clean all

# Install mergerfs from GitHub
RUN dnf install -y jq && \
    RPM_URL=$(curl -s https://api.github.com/repos/trapexit/mergerfs/releases/latest | jq -r '.assets[] | select(.name | test("fc42.x86_64.rpm$")) | .browser_download_url') && \
    dnf install -y "${RPM_URL}" && \
    dnf remove -y jq && dnf clean all
